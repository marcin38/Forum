@using PagedList;
@using PagedList.Mvc;

@model IPagedList<Domain.Models.User>

<link href="~/Content/jquery-ui.css" rel="stylesheet" />

<script type="text/javascript">
    $(document).ready(function () {
        var userTextBox = $('#user');
        
        userTextBox.keypress(function()
        {
            var term = $(this).val();
                $.ajax({
                    url: $('#indexLink').attr('href'),
                    data: { term: term },
                    method: 'GET',
                    success: function (data) {
                        var $target = $('#usersList');
                        $target.replaceWith(data);
                    }
                });
            
        })

        userTextBox.autocomplete({
            minLength: 1,
            select: function(event, ui){
                $.ajax({
                    url: $('#indexLink').attr('href'),
                    data: { term: ui.item.value },
                    method: 'GET',
                    success: function (data) {
                        var $target = $('#usersList');
                        $target.replaceWith(data);
                    }
                });
            },
            source:
                function (request, response) {
                $.ajax({
                    url: $('#namesLink').attr('href'),
                    data: { term: userTextBox.val() },
                    method: 'GET',
                    success: function (data) {
                        response(data);
                    }
                });
            }
        });
    });
</script>

@Html.ActionLink("Index", MVC.User.Index(),new {style="display:none", id = "indexLink"})
@Html.ActionLink("GetNames", MVC.User.GetNames(), new { style = "display:none", id="namesLink" })
@Html.Label("user", "Search")
@Html.TextBox("user", "", new { id = "user" })



@Html.Partial(MVC.User.Views._Table, Model)
